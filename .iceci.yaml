globals:
  dockerSecret: dockerhub

steps:
- name: build-docker-image-frontend
  runtimeProfile: nodejs
  containerBuild:
    user: mrupgrade
    imageName: smart-social-distancing
    dockerfilePath: frontend.Dockerfile
    cache:
      enable: true
    tags:
    - "{{ ICECI_GIT_TAG_OR_BRANCH }}-frontend"


- name: build-docker-image-x86
  containerBuild:
    user: mrupgrade
    imageName: smart-social-distancing
    dockerfilePath: x86.Dockerfile
    cache:
      enable: true
    tags:
    - "{{ ICECI_GIT_TAG_OR_BRANCH }}-x86"
    buildArgs:
    - name: frontend_uri
      value: "mrupgrade/smart-social-distancing:{{ ICECI_GIT_TAG_OR_BRANCH }}-frontend"


- name: build-docker-image-jetson-nano
  runtimeProfile: jetson
  containerBuild:
    user: mrupgrade
    imageName: smart-social-distancing
    dockerfilePath: jetson-nano.Dockerfile
    cache:
      enable: true
    tags:
    - "{{ ICECI_GIT_TAG_OR_BRANCH }}-jetson-nano"
    buildArgs:
    - name: frontend_uri
      value: "mrupgrade/smart-social-distancing:{{ ICECI_GIT_TAG_OR_BRANCH }}-frontend"